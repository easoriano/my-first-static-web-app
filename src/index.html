<!--<!DOCTYPE html>
    <html>
        <head>
          <title>My Page</title>
            </head>
                <body>
                     <h1>My Page</h1>
                        
                
                        <script type = "text/javascript" src="web.js"></script>
         
                        <p>Click the following button to see the function in action</p>  
                        <button type = "button1" onclick = "diabeties()" value = "Display">  
 
        </body>  
</html>-->

<!--<html>
  <head>
    <title>My App</title>
  </head>
  <body>
    <h1>Output</h1>
    <p>PatientID: {{ output.PatientID }}</p>
    <p>DiabetesPrediction: {{ output.DiabetesPrediction }}</p>
    <p>Probability: {{ output.Probability }}</p>
  </body>
</html>-->

<!DOCTYPE html>
<html>
  <head>
    <title>My HTML Page</title>
  </head>
  <body>
    <h1>My HTML Page</h1>
    <script>
      // Insert the JavaScript code here
        const RCurl = require('rcurl');
const rjson = require('rjson');

// Accept SSL certificates issued by public Certificate Authorities
RCurl.options.RCurlOptions = {
  cainfo: RCurl.system.file("CurlSSL", "cacert.pem", package = "RCurl"),
  ssl_verifypeer: false
};

const h = new RCurl.basicTextGatherer();
const hdr = new RCurl.basicHeaderGatherer();

// Request data goes here
// The example below assumes JSON formatting which may be updated
// depending on the format your endpoint expects.
// More information can be found here:
// https://docs.microsoft.com/azure/machine-learning/how-to-deploy-advanced-entry-script
const req = rjson.fromJSON('{
  "Inputs": {
    "input1": [
      {
        "PatientID": 1882185,
        "Pregnancies": 9,
        "PlasmaGlucose": 104,
        "DiastolicBloodPressure": 51,
        "TricepsThickness": 7,
        "SerumInsulin": 24,
        "BMI": 27.36983156,
        "DiabetesPedigree": 1.3504720469999998,
        "Age": 43
      },
      {
        "PatientID": 1662484,
        "Pregnancies": 6,
        "PlasmaGlucose": 73,
        "DiastolicBloodPressure": 61,
        "TricepsThickness": 35,
        "SerumInsulin": 24,
        "BMI": 18.74367404,
        "DiabetesPedigree": 1.074147566,
        "Age": 75
      },
      {
        "PatientID": 1228510,
        "Pregnancies": 4,
        "PlasmaGlucose": 115,
        "DiastolicBloodPressure": 50,
        "TricepsThickness": 29,
        "SerumInsulin": 243,
        "BMI": 34.69215364,
        "DiabetesPedigree": 0.7411599259999999,
        "Age": 59
      }
    ]
  },
  "GlobalParameters": {}
}');

const requestBody = RCurl.enc2utf8(rjson.toJSON(req));
// Replace this with the primary/secondary key or AMLToken for the endpoint
let api_key = "crDbBjiIZb2mgOGcJQnT7BPFsR5R64QZ";
if (api_key === "" || typeof api_key !== 'string')
{
    throw new Error("A key should be provided to invoke the endpoint");
}
const authz_hdr = `Bearer ${api_key}`;

h.reset();

// The azureml-model-deployment header will force the request to go to a specific deployment.
// Remove this header to have the request observe the endpoint traffic rules
RCurl.curlPerform(
    url = "http://20.252.33.64:80/api/v1/service/predict-diabetes/score",
    httpheader = [
        'Content-Type: application/json',
        `Authorization: ${authz_hdr}`,
        'azureml-model-deployment-id: 00000000-0000-0000-0000-000000000000'
    ],
    postfields = requestBody,
    writefunction = h.update,
    headerfunction = hdr.update,
    verbose = true
);

const headers = hdr.value();
const httpStatus = headers["status"];

    </script>
  </body>
</html>
